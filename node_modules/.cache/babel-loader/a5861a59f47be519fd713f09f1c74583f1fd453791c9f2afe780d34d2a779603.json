{"ast":null,"code":"import _objectSpread from\"C:/Users/SR/Downloads/full_project/frontend/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import React,{createContext,useState,useContext,useEffect}from\"react\";import{useAuth}from\"./AuthContext\";import axios from\"axios\";import{API_BASE_URL,ENDPOINTS}from\"../constants/config\";import{jsx as _jsx}from\"react/jsx-runtime\";const WishlistContext=/*#__PURE__*/createContext();export const WishlistProvider=_ref=>{let{children}=_ref;const{user,token}=useAuth();const[wishlist,setWishlist]=useState([]);const[loading,setLoading]=useState(false);// Load wishlist from localStorage on mount\nuseEffect(()=>{const savedWishlist=localStorage.getItem(\"wishlist\");if(savedWishlist){try{setWishlist(JSON.parse(savedWishlist));}catch(err){console.error(\"Error loading wishlist:\",err);}}},[]);// Sync wishlist with backend when user logs in\nuseEffect(()=>{if(user&&token){fetchWishlistFromBackend();}},[user,token]);// Save wishlist to localStorage whenever it changes\nuseEffect(()=>{localStorage.setItem(\"wishlist\",JSON.stringify(wishlist));},[wishlist]);const fetchWishlistFromBackend=async()=>{try{setLoading(true);const response=await axios.get(\"\".concat(API_BASE_URL).concat(ENDPOINTS.WISHLIST),{headers:{Authorization:\"Bearer \".concat(token)}});const wishlistItems=response.data.items.map(item=>({id:item.product_id,name:item.name,price:item.price,image:item.image,description:item.description,addedAt:item.added_at}));setWishlist(wishlistItems);}catch(err){console.error(\"Error fetching wishlist from backend:\",err);}finally{setLoading(false);}};const addToWishlist=async product=>{setWishlist(prev=>{const exists=prev.find(item=>item.id===product.id);if(exists){return prev;}return[...prev,_objectSpread(_objectSpread({},product),{},{addedAt:new Date().toISOString()})];});// Sync with backend if user is logged in\nif(user&&token){try{await axios.post(\"\".concat(API_BASE_URL).concat(ENDPOINTS.WISHLIST),{product_id:product.id},{headers:{Authorization:\"Bearer \".concat(token)}});}catch(err){console.error(\"Error adding item to backend wishlist:\",err);}}};const removeFromWishlist=async productId=>{setWishlist(prev=>prev.filter(item=>item.id!==productId));// Sync with backend if user is logged in\nif(user&&token){try{await axios.delete(\"\".concat(API_BASE_URL).concat(ENDPOINTS.WISHLIST,\"/\").concat(productId),{headers:{Authorization:\"Bearer \".concat(token)}});}catch(err){console.error(\"Error removing item from backend wishlist:\",err);}}};const isInWishlist=productId=>{return wishlist.some(item=>item.id===productId);};const clearWishlist=async()=>{setWishlist([]);// Note: Backend doesn't have clear all endpoint, delete individually if needed\nif(user&&token){try{for(const item of wishlist){await axios.delete(\"\".concat(API_BASE_URL).concat(ENDPOINTS.WISHLIST,\"/\").concat(item.id),{headers:{Authorization:\"Bearer \".concat(token)}});}}catch(err){console.error(\"Error clearing backend wishlist:\",err);}}};const getWishlistCount=()=>{return wishlist.length;};return/*#__PURE__*/_jsx(WishlistContext.Provider,{value:{wishlist,addToWishlist,removeFromWishlist,isInWishlist,clearWishlist,getWishlistCount,loading},children:children});};export const useWishlist=()=>{const context=useContext(WishlistContext);if(!context){throw new Error(\"useWishlist must be used within WishlistProvider\");}return context;};","map":{"version":3,"names":["React","createContext","useState","useContext","useEffect","useAuth","axios","API_BASE_URL","ENDPOINTS","jsx","_jsx","WishlistContext","WishlistProvider","_ref","children","user","token","wishlist","setWishlist","loading","setLoading","savedWishlist","localStorage","getItem","JSON","parse","err","console","error","fetchWishlistFromBackend","setItem","stringify","response","get","concat","WISHLIST","headers","Authorization","wishlistItems","data","items","map","item","id","product_id","name","price","image","description","addedAt","added_at","addToWishlist","product","prev","exists","find","_objectSpread","Date","toISOString","post","removeFromWishlist","productId","filter","delete","isInWishlist","some","clearWishlist","getWishlistCount","length","Provider","value","useWishlist","context","Error"],"sources":["C:/Users/SR/Downloads/full_project/frontend/src/context/WishlistContext.jsx"],"sourcesContent":["import React, { createContext, useState, useContext, useEffect } from \"react\";\r\nimport { useAuth } from \"./AuthContext\";\r\nimport axios from \"axios\";\r\nimport { API_BASE_URL, ENDPOINTS } from \"../constants/config\";\r\n\r\nconst WishlistContext = createContext();\r\n\r\nexport const WishlistProvider = ({ children }) => {\r\n  const { user, token } = useAuth();\r\n  const [wishlist, setWishlist] = useState([]);\r\n  const [loading, setLoading] = useState(false);\r\n\r\n  // Load wishlist from localStorage on mount\r\n  useEffect(() => {\r\n    const savedWishlist = localStorage.getItem(\"wishlist\");\r\n    if (savedWishlist) {\r\n      try {\r\n        setWishlist(JSON.parse(savedWishlist));\r\n      } catch (err) {\r\n        console.error(\"Error loading wishlist:\", err);\r\n      }\r\n    }\r\n  }, []);\r\n\r\n  // Sync wishlist with backend when user logs in\r\n  useEffect(() => {\r\n    if (user && token) {\r\n      fetchWishlistFromBackend();\r\n    }\r\n  }, [user, token]);\r\n\r\n  // Save wishlist to localStorage whenever it changes\r\n  useEffect(() => {\r\n    localStorage.setItem(\"wishlist\", JSON.stringify(wishlist));\r\n  }, [wishlist]);\r\n\r\n  const fetchWishlistFromBackend = async () => {\r\n    try {\r\n      setLoading(true);\r\n      const response = await axios.get(`${API_BASE_URL}${ENDPOINTS.WISHLIST}`, {\r\n        headers: { Authorization: `Bearer ${token}` },\r\n      });\r\n      const wishlistItems = response.data.items.map((item) => ({\r\n        id: item.product_id,\r\n        name: item.name,\r\n        price: item.price,\r\n        image: item.image,\r\n        description: item.description,\r\n        addedAt: item.added_at,\r\n      }));\r\n      setWishlist(wishlistItems);\r\n    } catch (err) {\r\n      console.error(\"Error fetching wishlist from backend:\", err);\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  const addToWishlist = async (product) => {\r\n    setWishlist((prev) => {\r\n      const exists = prev.find((item) => item.id === product.id);\r\n      if (exists) {\r\n        return prev;\r\n      }\r\n      return [...prev, { ...product, addedAt: new Date().toISOString() }];\r\n    });\r\n\r\n    // Sync with backend if user is logged in\r\n    if (user && token) {\r\n      try {\r\n        await axios.post(\r\n          `${API_BASE_URL}${ENDPOINTS.WISHLIST}`,\r\n          { product_id: product.id },\r\n          { headers: { Authorization: `Bearer ${token}` } }\r\n        );\r\n      } catch (err) {\r\n        console.error(\"Error adding item to backend wishlist:\", err);\r\n      }\r\n    }\r\n  };\r\n\r\n  const removeFromWishlist = async (productId) => {\r\n    setWishlist((prev) => prev.filter((item) => item.id !== productId));\r\n\r\n    // Sync with backend if user is logged in\r\n    if (user && token) {\r\n      try {\r\n        await axios.delete(`${API_BASE_URL}${ENDPOINTS.WISHLIST}/${productId}`, {\r\n          headers: { Authorization: `Bearer ${token}` },\r\n        });\r\n      } catch (err) {\r\n        console.error(\"Error removing item from backend wishlist:\", err);\r\n      }\r\n    }\r\n  };\r\n\r\n  const isInWishlist = (productId) => {\r\n    return wishlist.some((item) => item.id === productId);\r\n  };\r\n\r\n  const clearWishlist = async () => {\r\n    setWishlist([]);\r\n\r\n    // Note: Backend doesn't have clear all endpoint, delete individually if needed\r\n    if (user && token) {\r\n      try {\r\n        for (const item of wishlist) {\r\n          await axios.delete(`${API_BASE_URL}${ENDPOINTS.WISHLIST}/${item.id}`, {\r\n            headers: { Authorization: `Bearer ${token}` },\r\n          });\r\n        }\r\n      } catch (err) {\r\n        console.error(\"Error clearing backend wishlist:\", err);\r\n      }\r\n    }\r\n  };\r\n\r\n  const getWishlistCount = () => {\r\n    return wishlist.length;\r\n  };\r\n\r\n  return (\r\n    <WishlistContext.Provider\r\n      value={{\r\n        wishlist,\r\n        addToWishlist,\r\n        removeFromWishlist,\r\n        isInWishlist,\r\n        clearWishlist,\r\n        getWishlistCount,\r\n        loading,\r\n      }}\r\n    >\r\n      {children}\r\n    </WishlistContext.Provider>\r\n  );\r\n};\r\n\r\nexport const useWishlist = () => {\r\n  const context = useContext(WishlistContext);\r\n  if (!context) {\r\n    throw new Error(\"useWishlist must be used within WishlistProvider\");\r\n  }\r\n  return context;\r\n};\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}