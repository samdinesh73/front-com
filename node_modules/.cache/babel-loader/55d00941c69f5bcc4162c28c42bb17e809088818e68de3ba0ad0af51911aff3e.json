{"ast":null,"code":"import React,{createContext,useContext,useEffect,useState}from\"react\";import{API_BASE_URL,ENDPOINTS}from\"../constants/config\";import{jsx as _jsx}from\"react/jsx-runtime\";const AuthContext=/*#__PURE__*/createContext(null);export const AuthProvider=_ref=>{let{children}=_ref;const[user,setUser]=useState(null);const[token,setToken]=useState(()=>{try{return localStorage.getItem(\"auth_token\")||null;}catch(e){return null;}});const[loading,setLoading]=useState(true);// Verify token on mount\nuseEffect(()=>{if(token){verifyToken(token);}else{setLoading(false);}},[]);const verifyToken=async tok=>{try{const resp=await fetch(\"\".concat(API_BASE_URL).concat(ENDPOINTS.AUTH_ME),{headers:{Authorization:\"Bearer \".concat(tok)}});if(resp.ok){const data=await resp.json();setUser(data.user);}else{setToken(null);localStorage.removeItem(\"auth_token\");}}catch(err){console.error(\"Token verification error:\",err);}finally{setLoading(false);}};const signup=async(email,password,name)=>{try{const resp=await fetch(\"\".concat(API_BASE_URL).concat(ENDPOINTS.AUTH_SIGNUP),{method:\"POST\",headers:{\"Content-Type\":\"application/json\"},body:JSON.stringify({email,password,name})});if(!resp.ok){const err=await resp.json();throw new Error(err.error||\"Signup failed\");}const data=await resp.json();setToken(data.token);setUser(data.user);localStorage.setItem(\"auth_token\",data.token);return data;}catch(err){throw err;}};const signin=async(email,password)=>{try{const resp=await fetch(\"\".concat(API_BASE_URL).concat(ENDPOINTS.AUTH_SIGNIN),{method:\"POST\",headers:{\"Content-Type\":\"application/json\"},body:JSON.stringify({email,password})});if(!resp.ok){const err=await resp.json();throw new Error(err.error||\"Signin failed\");}const data=await resp.json();setToken(data.token);setUser(data.user);localStorage.setItem(\"auth_token\",data.token);return data;}catch(err){throw err;}};const logout=()=>{setToken(null);setUser(null);localStorage.removeItem(\"auth_token\");};return/*#__PURE__*/_jsx(AuthContext.Provider,{value:{user,token,loading,signup,signin,logout},children:children});};export const useAuth=()=>{const ctx=useContext(AuthContext);if(!ctx)throw new Error(\"useAuth must be used within AuthProvider\");return ctx;};export default AuthContext;","map":{"version":3,"names":["React","createContext","useContext","useEffect","useState","API_BASE_URL","ENDPOINTS","jsx","_jsx","AuthContext","AuthProvider","_ref","children","user","setUser","token","setToken","localStorage","getItem","e","loading","setLoading","verifyToken","tok","resp","fetch","concat","AUTH_ME","headers","Authorization","ok","data","json","removeItem","err","console","error","signup","email","password","name","AUTH_SIGNUP","method","body","JSON","stringify","Error","setItem","signin","AUTH_SIGNIN","logout","Provider","value","useAuth","ctx"],"sources":["C:/Users/SR/Downloads/full_project/frontend/src/context/AuthContext.jsx"],"sourcesContent":["import React, { createContext, useContext, useEffect, useState } from \"react\";\r\nimport { API_BASE_URL, ENDPOINTS } from \"../constants/config\";\r\n\r\nconst AuthContext = createContext(null);\r\n\r\nexport const AuthProvider = ({ children }) => {\r\n  const [user, setUser] = useState(null);\r\n  const [token, setToken] = useState(() => {\r\n    try {\r\n      return localStorage.getItem(\"auth_token\") || null;\r\n    } catch (e) {\r\n      return null;\r\n    }\r\n  });\r\n  const [loading, setLoading] = useState(true);\r\n\r\n  // Verify token on mount\r\n  useEffect(() => {\r\n    if (token) {\r\n      verifyToken(token);\r\n    } else {\r\n      setLoading(false);\r\n    }\r\n  }, []);\r\n\r\n  const verifyToken = async (tok) => {\r\n    try {\r\n      const resp = await fetch(`${API_BASE_URL}${ENDPOINTS.AUTH_ME}`, {\r\n        headers: { Authorization: `Bearer ${tok}` },\r\n      });\r\n      if (resp.ok) {\r\n        const data = await resp.json();\r\n        setUser(data.user);\r\n      } else {\r\n        setToken(null);\r\n        localStorage.removeItem(\"auth_token\");\r\n      }\r\n    } catch (err) {\r\n      console.error(\"Token verification error:\", err);\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  const signup = async (email, password, name) => {\r\n    try {\r\n      const resp = await fetch(`${API_BASE_URL}${ENDPOINTS.AUTH_SIGNUP}`, {\r\n        method: \"POST\",\r\n        headers: { \"Content-Type\": \"application/json\" },\r\n        body: JSON.stringify({ email, password, name }),\r\n      });\r\n\r\n      if (!resp.ok) {\r\n        const err = await resp.json();\r\n        throw new Error(err.error || \"Signup failed\");\r\n      }\r\n\r\n      const data = await resp.json();\r\n      setToken(data.token);\r\n      setUser(data.user);\r\n      localStorage.setItem(\"auth_token\", data.token);\r\n      return data;\r\n    } catch (err) {\r\n      throw err;\r\n    }\r\n  };\r\n\r\n  const signin = async (email, password) => {\r\n    try {\r\n      const resp = await fetch(`${API_BASE_URL}${ENDPOINTS.AUTH_SIGNIN}`, {\r\n        method: \"POST\",\r\n        headers: { \"Content-Type\": \"application/json\" },\r\n        body: JSON.stringify({ email, password }),\r\n      });\r\n\r\n      if (!resp.ok) {\r\n        const err = await resp.json();\r\n        throw new Error(err.error || \"Signin failed\");\r\n      }\r\n\r\n      const data = await resp.json();\r\n      setToken(data.token);\r\n      setUser(data.user);\r\n      localStorage.setItem(\"auth_token\", data.token);\r\n      return data;\r\n    } catch (err) {\r\n      throw err;\r\n    }\r\n  };\r\n\r\n  const logout = () => {\r\n    setToken(null);\r\n    setUser(null);\r\n    localStorage.removeItem(\"auth_token\");\r\n  };\r\n\r\n  return (\r\n    <AuthContext.Provider value={{ user, token, loading, signup, signin, logout }}>\r\n      {children}\r\n    </AuthContext.Provider>\r\n  );\r\n};\r\n\r\nexport const useAuth = () => {\r\n  const ctx = useContext(AuthContext);\r\n  if (!ctx) throw new Error(\"useAuth must be used within AuthProvider\");\r\n  return ctx;\r\n};\r\n\r\nexport default AuthContext;\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}